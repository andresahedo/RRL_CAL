<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
   xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui"
   xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:pe="http://primefaces.org/ui/extensions"
   xmlns:c="http://java.sun.com/jsp/jstl/core">
   <ui:composition template="/WEB-INF/facelets/templates/layout.xhtml">
      <ui:define name="content">
         <f:event listener="#{autorizarController.validaAcceso}" type="preRenderView" />
         <style type="text/css">
            .ui-panel {
            border-style: none !important;
            width: #{sessionScope.tamanioApp}#{sessionScope.tipoTamanioApp};
            }
            .resolucionImportante {
            background: yellow !important;
            }
            .panelMontoStyle td {
            border-style: hidden !important;
            }
            .ui-selectonemenu-panel {
            width: 60%;
            }
            .table-no-select-all .ui-chkbox-all {
            visibility: hidden;
            }
            .ui-button-icon-only {
            display: none;
            }
         </style>
         <p:ajaxStatus onstart="statusDialog.show();" oncomplete="statusDialog.hide();" />
         <p:dialog modal="true" widgetVar="statusDialog" resizable="false" header="#{msg['vuj.estatus.procesando']}"
            draggable="false" closable="false">
            <p:graphicImage value="/resources/images/ajaxloadingbar.gif" />
         </p:dialog>
         <p:panel>
            <table align="right" width="100%">
               <tr>
                  <td>
                     <p:commandButton id="actualizarTableButton" process="@this" style="display:none"
                        partialSubmit="true" oncomplete="unselectCheckResol();"
                        actionListener="#{autorizarController.actualizarBanderaResolucionImpugnada}"
                        update=":resolucionForm,:idBanderaResolucionImpugnada" ajax="true"
                        widgetVar="actualizarButton" value="actualizar" />
                  </td>
                  <td>
                     <p:inputText style="display:none" value="#{autorizarController.banderaResolucionImpugnada}"
                        id="idBanderaResolucionImpugnada" />
                  </td>
               </tr>
            </table>
         </p:panel>
         <h:form id="resolucionForm">
            <p:panel id="funcionarioPanel">
               <table align="right" width="100%">
                  <tr>
                     <td></td>
                     <td></td>
                     <td align="right">
                        <p:commandButton id="backButton" value="#{msg['vuj.boton.anterior']}"
                           actionListener="#{autorizarController.cargaDatos}" process="@this" ajax="true"
                           update="@form" />
                        <p:commandButton id="guardarButtonP" value="Guardar"
                           oncomplete="cdGuardarResImp.show()" disabled="#{autorizarController.inhabilitarGuardar}">
                        </p:commandButton>
                        <p:confirmDialog message="#{msg['vuj.confirmacion']}" showEffect="fade"
                           hideEffect="explode" header="Confirmación" severity="alert" widgetVar="cdGuardarResImp">
                           <table align="right">
                              <tr>
                                 <td>
                                    <p:commandButton value="Si"
                                       actionListener="#{autorizarController.guardarResolucionesImpugnadas}"
                                       styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
                                       update=":resolucionForm:msgPanelRes, :infoAdicionalForm, :resolucionForm"
                                       process="@this,:resolucionForm:numeroOficio, :resolucionForm:fechaOficio"
                                       oncomplete="cdGuardarResImp.hide();unselectCheckResol()" />
                                    <p:commandButton
                                       value="No" onclick="cdGuardarResImp.hide();" type="button"
                                       styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                 </td>
                              </tr>
                           </table>
                        </p:confirmDialog>
                        <p:commandButton id="siguienteButton" partialSubmit="true"
                           update=":resolucionForm:msgPanelRes, resolucionForm:confirmarDialogo"
                           action="#{autorizarController.siguienteAdjuntar}" process="@this"
                           value="#{msg['vuj.autorizar.siguiente']}" disabled="#{autorizarController.banderaGuardar}">
                        </p:commandButton>
                        <p:commandButton id="rechazarButton" value="#{msg['vuj.boton.rechazar']}"
                           oncomplete="cdRechazarRes.show()">
                        </p:commandButton>
                        <p:confirmDialog message="#{msg['vuj.confirmacion.rechazo.resolucion']}" showEffect="fade"
                           hideEffect="explode" header="Confirmación" severity="alert" widgetVar="cdRechazarRes">
                           <table align="right">
                              <tr>
                                 <td>
                                    <p:commandButton value="Si"
                                       actionListener="#{autorizarController.rechazarResolucion}"
                                       styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
                                       update=":resolucionForm:msgPanelRes" process="@this"
                                       oncomplete="cdRechazarRes.hide()" />
                                    <p:commandButton value="No"
                                       onclick="cdRechazarRes.hide();" type="button"
                                       styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                 </td>
                              </tr>
                           </table>
                        </p:confirmDialog>
                     </td>
                  </tr>
               </table>
               <table>
                  <tr>
                     <td>
                        <h:outputText value="#{msg['vuj.resol.funcionario']}" />
                     </td>
                     <td>
                        <h:outputText value="#{msg['vuj.resol.rfcFuncionario']}" />
                     </td>
                     <td colspan="2" align="left">
                        <h:outputText value="#{msg['vuj.resol.estadoProcesal']}" />
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:inputText disabled="true" maxlength="500" readonly="true" id="funcionarioInput"
                           value="#{autorizarController.userProfile.nombreCompleto}" />
                     </td>
                     <td>
                        <p:inputText disabled="true" maxlength="13"
                           value="#{autorizarController.userProfile.rfc}" readonly="true" id="rfcFuncionarioInput" />
                     </td>
                     <td colspan="2" align="left">
                        <p:inputText maxlength="32" readonly="true"
                           value="#{autorizarController.abogadoDTO.tramiteDTO.estadoProcesal}"
                           id="estadoProcesalInput" />
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <h:outputText value="#{msg['vuj.resol.numAsunto']}" />
                     </td>
                     <td>
                        <h:outputText value="#{msg['vuj.fechaRecepcion']}" />
                     </td>
                     <td>
                        <h:outputText value="#{msg['vuj.resol.fechaVenc']}" />
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:inputText readonly="true" maxlength="13"
                           value="#{autorizarController.abogadoDTO.tramiteDTO.numeroAsunto}" id="numAsuntoInput" />
                     </td>
                     <td>
                        <p:inputText readonly="true"
                           value="#{autorizarController.abogadoDTO.tramiteDTO.fechaRecepcion}"
                           id="fechaRecepcionInput">
                           <f:convertDateTime pattern="dd/MM/yyyy" />
                        </p:inputText>
                     </td>
                     <td>
                        <p:inputText readonly="true"
                           value="#{autorizarController.abogadoDTO.tramiteDTO.fechaVencimiento}"
                           id="fechaVencimientoInput">
                           <f:convertDateTime pattern="dd/MM/yyyy" />
                        </p:inputText>
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:outputLabel value="#{msg['rrl.autorizar.fechaOficioResol']}"></p:outputLabel>
                     </td>
                     <td>
                        <p:outputLabel value="#{msg['rrl.autorizar.numOficioResol']}"></p:outputLabel>
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:calendar id="fechaOficio" value="#{autorizarController.abogadoDTO.fechaEmision}"
                           pattern="dd/MM/yyyy" locale="es" navigator="true" readonlyInput="true" required="true"
                           maxdate="autorizarController.fechaMaxima"></p:calendar>
                     </td>
                     <td>
                        <p:inputText id="numeroOficio" value="#{autorizarController.abogadoDTO.numeroOficio}">
                        </p:inputText>
                     </td>
                  </tr>
               </table>
               <p:panel>
                  <p:confirmDialog closable="false" global="false"
                     message="#{msg['rrl.mensaje.documento.complementario']}"
                     visible="#{autorizarController.nuevoDocumento}" id="confirmarDialogo"
                     widgetVar="confirmarAccion" showEffect="fade">
                     <table width="100%">
                        <tr>
                           <td align="right">
                              <p:commandButton oncomplete="confirmarAccion.hide()" value="Si"
                                 process="@this,confirmarDialogo"
                                 action="#{autorizarController.continuarSiguienteAdjuntar}"
                                 styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
                                 update=":resolucionForm:msgPanelRes" />
                              <p:commandButton value="No"
                                 oncomplete="confirmarAccion.hide()" process="@this,confirmarDialogo"
                                 action="#{autorizarController.regresarPaginaAutorizacion}"
                                 styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                           </td>
                        </tr>
                     </table>
                  </p:confirmDialog>
               </p:panel>
            </p:panel>
            <p:panel id="panelForm" header="  Resoluciones Impugnadas ">
               <p:panel id="msgPanelRes">
                  <p:panel rendered="#{autorizarController.blnMensajeDefensa}" style="width:100%">
                     <div class="ui-messages ui-widget" id="mensajeMedioDefensa">
                        <div class="ui-messages-info ui-corner-all">
                           <span class="ui-messages-info-icon"></span>
                           <ul>
                              <li>
                                 <span class="ui-messages-info-detail" /> 
                                 <h:outputText
                                    value="#{msg['rrl.resol.impugnada.aviso']}" />
                              </li>
                           </ul>
                        </div>
                     </div>
                  </p:panel>
                  <p:messages id="messagesRes" showDetail="true" globalOnly="true" />
               </p:panel>
               <table width="90%">
                  <tr>
                     <td>
                        <h:outputText value="#{msg['vuj.autorizar.resImpugnada']} " />
                        <h:graphicImage
                           id="ayudaIdResImp" url="/resources/css/images/ayuda.png" />
                        <pe:tooltip
                           for="ayudaIdResImp" value="#{msg['atender.requerimiento.resolucionImpugnada']}"
                           adjustX="20" adjustY="20" mouseTracking="true" showEffect="fade" />
                     </td>
                     <td>
                        <h:outputText value="#{msg['vuj.autoridadEmisora']} " />
                        <h:graphicImage
                           id="ayudaIdAutoridad" url="/resources/css/images/ayuda.png" />
                        <pe:tooltip
                           for="ayudaIdAutoridad" value="#{msg['atender.requerimiento.autoridadEmisora']}"
                           adjustX="20" adjustY="20" mouseTracking="true" showEffect="fade" />
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:inputText value="#{autorizarController.resol.resImpugnada}" id="resImpugnadaInput"
                           required="true" maxlength="35"
                           validatorMessage="#{errmsg['vuj.resolucion.resolInvalida']}">
                           <f:validateRegex pattern="^[A-Z0-9ñÑ.%()\-\/]{1,35}$"></f:validateRegex>
                        </p:inputText>
                        <p:message display="text" for="resImpugnadaInput" />
                     </td>
                     <td colspan="1">
                        <p:selectOneMenu effect="fade" id="autoridadEmisoraSelect"
                           style="width:500px;" value="#{autorizarController.resol.autoridadEmisora}"
                           required="true" converter="#{autoridadConverter}" filter="true"
                           filterMatchMode="contains">
                           <f:selectItem itemValue="" itemLabel="#{msg['vuj.combo.seleccione']}" />
                           <f:selectItems value="#{autorizarController.autoridadEmisoras}" var="autoridad"
                              itemValue="#{autoridad}" itemLabel="#{autoridad.nombre}" />
                        </p:selectOneMenu>
                        <p:message display="text" for="autoridadEmisoraSelect" />
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <h:outputText value="#{msg['vuj.autorizar.procedimiento']} " />
                        <h:graphicImage
                           id="ayudaIdProced" url="/resources/css/images/ayuda.png" />
                        <pe:tooltip
                           for="ayudaIdProced" value="#{msg['atender.requerimiento.procedimientoDeriva']}"
                           adjustX="20" adjustY="20" mouseTracking="true" showEffect="fade" />
                     </td>
                  </tr>
                  <tr>
                     <td colspan="2">
                        <p:selectOneMenu effect="fade" id="procedimientoSelect"
                           style="width:500px;" converter="#{procedimientoConverter}"
                           value="#{autorizarController.resol.procedimiento}" required="true" filter="true"
                           filterMatchMode="contains">
                           <f:selectItem itemValue="" itemLabel="#{msg['vuj.combo.seleccione']}" />
                           <f:selectItems value="#{autorizarController.listaProcedimientos}" var="procedimiento"
                              itemValue="#{procedimiento}" itemLabel="#{procedimiento.descripcion}" />
                        </p:selectOneMenu>
                        <p:message display="text" for="procedimientoSelect" />
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <h:outputText value="#{msg['vuj.autorizar.fechaEmision']} " />
                        <h:graphicImage
                           id="ayudaIdFecEmision" url="/resources/css/images/ayuda.png" />
                        <pe:tooltip
                           for="ayudaIdFecEmision" value="#{msg['atender.requerimiento.fechaEmision']}"
                           adjustX="20" adjustY="20" mouseTracking="true" showEffect="fade" />
                     </td>
                     <td>
                        <h:outputText value="#{msg['vuj.autorizar.sentido']} " />
                        <h:graphicImage
                           id="ayudaIdSentido" url="/resources/css/images/ayuda.png" />
                        <pe:tooltip
                           for="ayudaIdSentido" value="#{msg['atender.requerimiento.sentido']}" adjustX="20"
                           adjustY="20" mouseTracking="true" showEffect="fade" />
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:calendar pattern="dd/MM/yyyy" locale="es" navigator="true" readonlyInput="true"
                           value="#{autorizarController.resol.fechaEmision}"
                           maxdate="#{autorizarController.fechaMaxima}" id="fechaEmisionInput" required="true" />
                        <p:message for="fechaEmisionInput" display="text" />
                     </td>
                     <td>
                        <p:selectOneMenu id="selectSentido" effect="fade"
                           value="#{autorizarController.resol.ideSentidoResolucion}" required="true"
                           converter="#{sentidoResolucionConverter}" filter="true" filterMatchMode="contains">
                           <f:selectItem itemValue="" itemLabel="#{msg['vuj.combo.seleccione']}" />
                           <f:selectItems value="#{autorizarController.sentidosResolucion}" var="sentido"
                              itemValue="#{sentido}" itemLabel="#{sentido.descripcion}" />
                        </p:selectOneMenu>
                        <p:message for="selectSentido" display="text" />
                     </td>
                  </tr>
                  <tr>
                     <td></td>
                     <td>
                        <h:outputText value="#{msg['vuj.resol.monto']}" />
                        <h:graphicImage id="ayudaIdMonto"
                           url="/resources/css/images/ayuda.png" />
                        <pe:tooltip for="ayudaIdMonto"
                           value="#{msg['atender.requerimiento.importe']}" adjustX="20" adjustY="20"
                           mouseTracking="true" showEffect="fade" />
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:selectBooleanCheckbox id="determinanteCred"
                           value="#{autorizarController.determinanteCred}">
                           <p:ajax event="valueChange" update=":resolucionForm:montoInput"
                              oncomplete="resetearMonto();deshabilitaMontoImput();"
                              listener="#{autorizarController.determinanteChangeEvent}"></p:ajax>
                        </p:selectBooleanCheckbox>
                        <h:outputText value="#{msg['vuj.resol.determinanteCred']}" />
                        <h:graphicImage
                           id="ayudaIdDetCred" url="/resources/css/images/ayuda.png" />
                        <pe:tooltip
                           for="ayudaIdDetCred" value="#{msg['atender.requerimiento.determinanteCredito']}"
                           adjustX="20" adjustY="20" mouseTracking="true" showEffect="fade" />
                     </td>
                     <td>
                        <p:outputLabel>$</p:outputLabel>
                        <pe:inputNumber id="montoInput" required="true"
                           emptyValue="0.00" disabled="#{autorizarController.banderaMonto}"
                           validatorMessage="#{errmsg['vuj.resol.importe']}" minValue="0.00"
                           maxValue="99999999999999.99" maxlength="16" decimalPlaces="2" thousandSeparator=","
                           value="#{autorizarController.montoValor}">
                        </pe:inputNumber>
                        <p:message for="montoInput" display="text"></p:message>
                     </td>
                  </tr>
                  <tr>
                     <td align="right" colspan="5">
                        <p:commandButton id="agregarResolucion" value="Agregar"
                           process=":resolucionForm:panelForm"
                           update=":resolucionForm,:infoAdicionalForm:resolucionSentidoPanel,:resolucionForm:msgPanelRes, resolucionTablePanel"
                           actionListener="#{autorizarController.agregarResolucion}"
                           oncomplete="ocultarMessages();resetearMonto();deshabilitaMontoImput();" />
                     </td>
                  </tr>
               </table>
            </p:panel>
            <p:panel id="resolucionTablePanel" header="  Resoluciones Impugnadas Agregadas ">
               <p:remoteCommand name="restoreMaxResolValueCommand"
                  actionListener="#{autorizarController.restoreMaxResolValue}"
                  oncomplete="alert('executed restoreMaxResolValueCommand')" />
               <p:remoteCommand name="deleteMaxResolValueCommand"
                  actionListener="#{autorizarController.deleteMaxResolValue}"
                  oncomplete="alert('executed deleteMaxResolValueCommand')" />
               <table style="float: left;" cellpadding="1" width="100%">
                  <tr>
                     <td colspan="2">
                        <p:scrollPanel style="height:200px;" id="usuariosPanel" mode="native">
                           <p:dataTable rowIndexVar="rowId" style="width:100%;border: 1px solid #848484;"
                              rowStyleClass="#{resol.importante == true ? 'resolucionImportante' : null }"
                              editable="#{not autorizarController.resolucionGuardada}" editMode="row"
                              id="resolucionTable" widgetVar="resolucionTableVar" var="resol"
                              selection="#{autorizarController.selectedResol}"
                              value="#{autorizarController.resolDataModel}"
                              emptyMessage="#{msg['vuj.grid.vacio']}" resizableColumns="true">
                              <f:attribute name="tableResolutions" value="#{autorizarController.resolDataModel}" />
                              <p:ajax event="rowEditInit"
                                    listener="#{autorizarController.onRowEditInit}"
                                    update=":resolucionForm:funcionarioPanel, :exFondoForm:panelExclusivoFondo"
                                 />
                              <p:ajax event="rowSelect" update=":infoAdicionalForm:conceptoPanel, :resolucionForm:funcionarioPanel, :exFondoForm:panelExclusivoFondo"
                                 listener="#{autorizarController.onRowSelect}" />
                              <p:ajax event="rowEdit" listener="#{autorizarController.editarResolucion}"
                                 update=":infoAdicionalForm:resolucionSentidoPanel,:resolucionForm:montoTotalControvertidoInput,:resolucionForm:montoInput, :infoAdicionalForm:conceptoPanel,:idBanderaResolucionImpugnada,:resolucionForm:msgPanelRes,:resolucionForm:elimRes, :resolucionForm:funcionarioPanel, :exFondoForm:panelExclusivoFondo"
                                 oncomplete="actualizarDataTable();" onstart="habilitatableMontoInput();" />
                              <p:ajax event="rowEditCancel" listener="#{autorizarController.resetResol}"
                                 update=":resolucionForm:montoTotalControvertidoInput, :resolucionForm:montoInput, :infoAdicionalForm:conceptoPanel,:resolucionForm:elimRes, :resolucionForm:funcionarioPanel, :exFondoForm:panelExclusivoFondo"
                                 resetValues="true" />
                              <p:ajax event="rowUnselect" listener="#{autorizarController.onRowUnselect}"
                                 update=":infoAdicionalForm:infoAdicionalPanel, :resolucionForm:funcionarioPanel, :exFondoForm:panelExclusivoFondo" />
                              <p:ajax event="rowSelectRadio"
                                 update=":infoAdicionalForm:conceptoPanel,@this, :infoAdicionalForm:panelAgravios,:resolucionForm:elimRes,:resolucionForm:funcionarioPanel, :exFondoForm:panelExclusivoFondo"
                                 oncomplete="borrarInputConcepto();"
                                 listener="#{autorizarController.onRowSelect}" />
                              <p:column selectionMode="single" style="width:2%;" />
                              <p:column headerText="#{msg['vuj.autorizar.resImpugnada']}" resizable="false"
                                 style="width:14%;white-space:pre-line;">
                                 <p:cellEditor>
                                    <f:facet name="output">
                                       <h:outputText value="#{resol.resImpugnada}" />
                                    </f:facet>
                                    <f:facet name="input">
                                       <p:inputText value="#{resol.resImpugnada}" required="true"
                                          id="tableResolucionInput" maxlength="35" style="width:100px;">
                                          <f:attribute name="msgFormato"
                                             value="#{errmsg['vuj.resolucion.resolInvalida']}"></f:attribute>
                                          <f:validator for="tableResolucionInput"
                                             validatorId="validatorAbogado"></f:validator>
                                       </p:inputText>
                                       <p:message for="tableResolucionInput" display="text" />
                                    </f:facet>
                                 </p:cellEditor>
                              </p:column>
                              <p:column headerText="#{msg['vuj.autorizar.procedimiento']}" resizable="false"
                                 style="width:24%;white-space:pre-line;">
                                 <p:cellEditor>
                                    <f:facet name="output">
                                       <h:outputText value="#{resol.procedimiento.descripcion}" />
                                    </f:facet>
                                    <f:facet name="input">
                                       <p:selectOneMenu converter="#{procedimientoConverter}"
                                          style="width:150px;" id="tableProcedimientoSelect" effect="fade"
                                          value="#{resol.procedimiento}" required="true" filter="true"
                                          filterMatchMode="contains">
                                          <f:selectItem itemValue=""
                                             itemLabel="#{msg['vuj.combo.seleccione']}" />
                                          <f:selectItems value="#{autorizarController.listaProcedimientos}"
                                             var="procedimiento" itemValue="#{procedimiento}"
                                             itemLabel="#{procedimiento.descripcion}" />
                                       </p:selectOneMenu>
                                       <p:message for="tableProcedimientoSelect" display="text" />
                                    </f:facet>
                                 </p:cellEditor>
                              </p:column>
                              <p:column headerText="#{msg['vuj.autoridadEmisora']}" resizable="false"
                                 style="width:14%;white-space:pre-line;">
                                 <p:cellEditor>
                                    <f:facet name="output">
                                       <h:outputText value="#{resol.autoridadEmisora.nombre}" />
                                    </f:facet>
                                    <f:facet name="input">
                                       <p:selectOneMenu effect="fade" converter="#{autoridadConverter}"
                                          style="width:110px;" value="#{resol.autoridadEmisora}"
                                          required="true" id="tableAutoridadSelect" filter="true"
                                          filterMatchMode="contains">
                                          <f:selectItem itemValue=""
                                             itemLabel="#{msg['vuj.combo.seleccione']}" />
                                          <f:selectItems value="#{autorizarController.autoridadEmisoras}"
                                             var="autoridad" itemValue="#{autoridad}"
                                             itemLabel="#{autoridad.nombre}" />
                                       </p:selectOneMenu>
                                       <p:message for="tableAutoridadSelect" display="text" />
                                    </f:facet>
                                 </p:cellEditor>
                              </p:column>
                              <p:column headerText="#{msg['vuj.autorizar.fechaEmision']}" resizable="false"
                                 style="width:10%;white-space:pre-line;">
                                 <p:cellEditor>
                                    <f:facet name="output">
                                       <h:outputText value="#{resol.fechaEmision}">
                                          <f:convertDateTime pattern="dd/MM/yyyy" />
                                       </h:outputText>
                                    </f:facet>
                                    <f:facet name="input">
                                       <p style="width: 20px">
                                          <p:calendar navigator="true" required="true" style="width:20px;"
                                             readonlyInput="true" id="tableFechaCalendar" locale="es"
                                             value="#{resol.fechaEmision}"
                                             maxdate="#{autorizarController.fechaMaxima}" />
                                          <p:message for="tableFechaCalendar" display="text" />
                                       </p>
                                    </f:facet>
                                 </p:cellEditor>
                              </p:column>
                              <p:column headerText="#{msg['vuj.resol.determinanteCredColumn']}" resizable="false"
                                 style="width:13%;white-space:pre-line;">
                                 <p:cellEditor>
                                    <f:facet name="output">
                                       <h:outputText id="determinanteCred"
                                          value="#{resol.determinanteCred le false ? 'Si' : 'No'}" />
                                    </f:facet>
                                    <f:facet name="input">
                                       <p:selectBooleanCheckbox id="determinanteCredId"
                                          itemLabel=" #{msg['vuj.resol.determinanteCred']}"
                                          value="#{resol.determinanteCred}" style="width:90px;">
                                          <p:ajax event="valueChange" onsuccess="reloadMontoResol(this)"
                                             listener="#{autorizarController.montoResolCheckChangeEvent}" />
                                       </p:selectBooleanCheckbox>
                                    </f:facet>
                                 </p:cellEditor>
                              </p:column>
                              <p:column headerText="#{msg['vuj.autorizar.monto']}" resizable="false"
                                 style="width:27%;white-space:pre-line;">
                                 <p:cellEditor id="panelMontoId">
                                    <f:facet name="output">
                                       <p align="center">
                                          <h:outputText value="#{resol.monto}" converter="bigDecimalConverter">
                                             <f:convertNumber type="currency" currencySymbol="$"/>
                                          </h:outputText>
                                       </p>
                                    </f:facet>
                                    <f:facet name="input">
                                       <pe:inputNumber minValue="0" emptyValue="0.00"
                                          maxValue="#{resol.maxMontoValue}" maxlength="16"
                                          disabled="#{!resol.determinanteCred}" id="tableMontoInput"
                                          required="true" value="#{resol.monto}"
                                          requiredMessage="#{msg['vuj.resol.camposObligatorios']}"
                                          decimalPlaces="2">
                                          <p:ajax event="blur" update="@this"
                                             listener="#{autorizarController.montoResolChangeEvent}" />
                                       </pe:inputNumber>
                                       <p:message for="tableMontoInput" display="text" />
                                    </f:facet>
                                 </p:cellEditor>
                              </p:column>
                              <p:column headerText="#{msg['vuj.autorizar.sentido']}" resizable="false"
                                 style="width:13%;white-space:pre-line;">
                                 <p style="width: 56px">
                                    <h:outputText value="#{resol.ideSentidoResolucion.descripcion}"
                                       style="width:100px;" />
                                 </p>
                              </p:column>
                              <p:column headerText="Editar" style="width:4%;white-space:pre-line;"
                                 resizable="false">
                                 <p:rowEditor rendered="#{resol.editarResolSelected}" />
                              </p:column>
                              <p:ajax event="rowEditInit" oncomplete="modificaMontoValor();"
                                 update=":resolucionForm:montoInput, :resolucionForm:resolucionTable:panelMontoId" />
                           </p:dataTable>
                           <pe:tooltip for="resolucionTablePanel"
                              value="#{msg['atender.requerimiento.resolucionesImpugnadas']}" mouseTracking="true"
                              myPosition="top left" adjustX="20" adjustY="20" />
                        </p:scrollPanel>
                     </td>
                  </tr>
                  <tr></tr>
                  <tr>
                     <td>
                        <h:outputText id="montoTotalID" value="#{msg['vuj.autorizar.montoTotal']} " />
                        <h:graphicImage
                           id="ayudaIdMontoT" url="/resources/css/images/ayuda.png" />
                        <pe:tooltip
                           for="ayudaIdMontoT" value="#{msg['atender.requerimiento.montoTotalControvertido']}"
                           adjustX="20" adjustY="20" mouseTracking="true" showEffect="fade" />
                     </td>
                     <td align="right" colspan="3">
                        <p:commandButton immediate="true" id="elimRes"
                           value="Eliminar" oncomplete="ocultarMessages(); cdEliminarRes.show();"
                           disabled="#{autorizarController.disableElimResol}"
                           update="resolucionTablePanel,panelForm,:resolucionForm,:resolucionForm:msgPanelRes,:infoAdicionalForm:infoAdicionalPanel,:exFondoForm:panelExFonDato">
                        </p:commandButton>
                        <p:confirmDialog message="#{msg['vuj.resolucion.confirmarElimnarResolucion']}"
                           showEffect="fade" hideEffect="explode" header="Confirmación" severity="alert"
                           widgetVar="cdEliminarRes">
                           <table align="right">
                              <tr>
                                 <td>
                                    <p:commandButton value="Si"
                                       actionListener="#{autorizarController.removeRow}"
                                       process="resolucionTablePanel" styleClass="ui-confirmdialog-yes"
                                       icon="ui-icon-check"
                                       update="resolucionTablePanel,panelForm,:resolucionForm,:resolucionForm:msgPanelRes,:infoAdicionalForm:infoAdicionalPanel"
                                       oncomplete="cdEliminarRes.hide()" />
                                    <p:commandButton value="No"
                                       onclick="cdEliminarRes.hide();" type="button"
                                       styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                 </td>
                              </tr>
                           </table>
                        </p:confirmDialog>
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:inputText readonly="true" converter="bigDecimalConverter"
                           id="montoTotalControvertidoInput" value="#{autorizarController.montoTotalControvertido}">
                           <f:convertNumber type="currency" currencySymbol="$" minFractionDigits="2" maxFractionDigits="2" />
                        </p:inputText>
                     </td>
                  </tr>
               </table>
               <p:panel id="panelEliminarResImp">
                  <p:confirmDialog closable="false" message="#{msg['vuj.resolucion.eliminarResolucion']}"
                     visible="false" id="confirmarDialog" widgetVar="confirmarAccion" showEffect="fade">
                     <table width="100%">
                        <tr>
                           <td align="right">
                              <p:commandButton oncomplete="confirmarAccion.hide()" value="Si"
                                 process="@this,confirmarDialog"
                                 update="@this,:resolucionForm:resolucionTablePanel"
                                 actionListener="#{autorizarController.removeConcepto}"
                                 styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                              <p:commandButton
                                 value="No" oncomplete="confirmarAccion.hide()" process="@this,confirmarDialog"
                                 update="@this,:resolucionForm:resolucionTablePanel"
                                 styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                           </td>
                        </tr>
                     </table>
                  </p:confirmDialog>
               </p:panel>
            </p:panel>
         </h:form>
         <h:form id="infoAdicionalForm">
            <p:panel id="infoAdicionalPanel" style="float:left;width: 100%;">
               <p:panel visible="#{autorizarController.visibleConceptoPanel}" id="conceptoPanel"
                  header="#{msg['vuj.autorizar.conceptoTit']}">
                  <p:panel id="msgConepto">
                     <div class="ui-messages ui-widget" style="display: none" id="errorConcepto">
                        <div class="ui-messages-error ui-corner-all">
                           <span class="ui-messages-error-icon"></span>
                           <ul>
                              <li>
                                 <span class="ui-messages-error-detail" /> 
                                 <h:outputText
                                    value="#{msg['vuj.resol.camposObligatorios']}" style="color:red" />
                              </li>
                           </ul>
                        </div>
                     </div>
                  </p:panel>
                  <p:panel id="resConcepto" style="float:left;width: 100%;">
                     <table>
                        <tr>
                           <td>
                              <h:outputText value="#{msg['vuj.autorizar.concepto']} " />
                              <h:graphicImage
                                 id="ayudaIdConcepto" url="/resources/css/images/ayuda.png" />
                              <pe:tooltip
                                 for="ayudaIdConcepto" value="#{msg['atender.requerimiento.concepto']}"
                                 adjustX="20" adjustY="20" mouseTracking="true" showEffect="fade" />
                           </td>
                        </tr>
                        <tr>
                           <td>
                              <p:selectOneMenu effect="fade" converter="#{conceptoConverter}"
                                 value="#{autorizarController.conceptosDTO.conceptoValor}"
                                 id="selectConceptoMenu" required="true" filter="true" filterMatchMode="contains">
                                 <f:selectItem itemValue="" itemLabel="#{msg['vuj.combo.seleccione']}" />
                                 <f:selectItems value="#{autorizarController.conceptoCats}" var="concepto"
                                    itemValue="#{concepto}" itemLabel="#{concepto.descripcion}" />
                              </p:selectOneMenu>
                              <p:message for="selectConceptoMenu" display="text" />
                           </td>
                        </tr>
                        <tr>
                           <td colspan="2">
                              <h:outputText value="#{msg['vuj.autorizar.importe']} " />
                              <h:graphicImage
                                 id="ayudaIdImporte" url="/resources/css/images/ayuda.png" />
                              <pe:tooltip
                                 for="ayudaIdImporte" value="#{msg['atender.requerimiento.importe']}"
                                 adjustX="20" adjustY="20" mouseTracking="true" showEffect="fade" />
                           </td>
                        </tr>
                        <tr>
                           <td>
                              <pe:inputNumber id="conceptoImporteInput" required="true" symbol="$"
                                 minValue="0.00" maxValue="99999999999999.99" maxlength="16" decimalPlaces="2"
                                 disabled="#{autorizarController.resolucionGuardada}"
                                 value="#{autorizarController.importeValor}">
                              </pe:inputNumber>
                              <p:message for="conceptoImporteInput" display="text" />
                              <pe:remoteCommand id="applyDataCommand" name="applyData" process="@this"   update=":infoAdicionalForm:resConcepto,:resolucionForm:resolucionTablePanel,:resolucionForm:msgPanelRes conceptoDataTable" 
                                 actionListener="#{autorizarController.resetCamposConcepto}" />
                           </td>
                        </tr>
                        <tr>
                           <td align="right" colspan="5">
                              <p:commandButton
                                 process=":infoAdicionalForm:conceptoImporteInput, :infoAdicionalForm:selectConceptoMenu"
                                 id="agregarConcepto" value="Agregar"
                                 update=":infoAdicionalForm:resConcepto"
                                 oncomplete="if(!args.validationFailed){validMensaje()}else{marcarRequeridoConceptoInput()}" />
                              <p:confirmDialog
                                 message="#{msg['vuj.resolucion.agregarConcepto']}" showEffect="fade"
                                 hideEffect="explode" id="cdAgregarConcepto" header="Confirmación"
                                 severity="alert" widgetVar="cdAgregarConcepto">
                                 <table align="right">
                                    <tr>
                                       <td>
                                          <p:commandButton value="Si" process="@this"
                                             actionListener="#{autorizarController.guardarConcepto}"
                                             styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
                                             update=":infoAdicionalForm:resConcepto,:resolucionForm:resolucionTablePanel,:resolucionForm:msgPanelRes conceptoDataTable"
                                             oncomplete="cdAgregarConcepto.hide();unselectCheckConceptos();" />
                                          <p:commandButton value="No" onclick="cdAgregarConcepto.hide();applyData();"
                                             type="button" styleClass="ui-confirmdialog-no"
                                             icon="ui-icon-close" />
                                       </td>
                                    </tr>
                                 </table>
                              </p:confirmDialog>
                           </td>
                        </tr>
                        <tr>
                           <td colspan="3">
                              <p:dataTable paginator="true" rows="5" rowKey="#{concepto.id}"
                                 selection="#{autorizarController.selectedConceptos}" resizableColumns="false"
                                 editMode="row" id="conceptoDataTable" editable="true"
                                 style="float:left;width: 100%;" var="concepto"
                                 value="#{autorizarController.conceptoDataModel}" widgetVar="conceptosDataTable"
                                 styleClass="table-no-select-all"
                                 emptyMessage="#{msg['vuj.grid.vacio']}">
                                 <p:ajax event="rowEdit" oncomplete="unselectCheckConceptos();"
                                    listener="#{autorizarController.editarConcepto}"
                                    update=":resolucionForm,conceptoDataTable" />
                                 <p:ajax event="rowEditCancel" listener="#{autorizarController.cancelConcepto}"
                                    update="conceptoDataTable,:infoAdicionalForm:elimCon" oncomplete="unselectCheckConceptos();" />
                                 <p:ajax event="rowEditInit" listener="#{autorizarController.respaldoConcepto}"
                                    update=":infoAdicionalForm:elimCon" />
                                 <p:ajax event="rowSelectCheckbox"
                                    listener="#{autorizarController.rowSelectCheckbox}"
                                    update=":infoAdicionalForm:resConcepto"></p:ajax>
                                 <p:ajax event="rowUnselectCheckbox"
                                    listener="#{autorizarController.rowUnselectCheckbox}"
                                    update=":infoAdicionalForm:resConcepto"></p:ajax>
                                 <p:column headerText="#{msg['vuj.autorizar.concepto']}"
                                    style="width:230px;white-space:pre-line;" resizable="false">
                                    <p:cellEditor>
                                       <f:facet name="input">
                                          <p:selectOneMenu id="tableConceptoSelect" effect="fade"
                                             converter="#{conceptoConverter}" style="width:230px;"
                                             value="#{concepto.conceptoValor}" required="true" filter="true"
                                             filterMatchMode="contains"
                                             requiredMessage="#{msg['vuj.resol.camposObligatorios']}">
                                             <f:selectItem itemValue=""
                                                itemLabel="#{msg['vuj.combo.seleccione']}" />
                                             <f:selectItems value="#{autorizarController.conceptoCats}"
                                                var="conceptoi" itemValue="#{conceptoi}"
                                                itemLabel="#{conceptoi.descripcion}" />
                                          </p:selectOneMenu>
                                          <p:message for="tableConceptoSelect" display="text" />
                                       </f:facet>
                                       <f:facet name="output">
                                          <h:outputText value="#{concepto.conceptoValor.descripcion}" />
                                       </f:facet>
                                    </p:cellEditor>
                                 </p:column>
                                 <p:column headerText="#{msg['vuj.autorizar.importe']}" resizable="false"
                                    style="width:100px;height:2%;white-space:pre-line;">
                                    <p:cellEditor>
                                       <f:facet name="input">
                                          <pe:inputNumber minValue="0" maxValue="99999999999999.99"
                                             id="tableImporteInput" emptyValue="0.00"
                                             value="#{autorizarController.importeValor}"
                                             disabled="#{autorizarController.resolucionGuardada}"
                                             required="true"
                                             requiredMessage="#{msg['vuj.resol.camposObligatorios']}">
                                          </pe:inputNumber>
                                          <p:message for="tableImporteInput" display="text" />
                                       </f:facet>
                                       <f:facet name="output">
                                          <h:outputText value="#{concepto.importe}"
                                             converter="bigDecimalConverter">
                                             <f:convertNumber type="currency" currencySymbol="$" minFractionDigits="2"
                                                maxFractionDigits="2" />
                                          </h:outputText>
                                       </f:facet>
                                    </p:cellEditor>
                                 </p:column>
                                 <p:column selectionMode="multiple" style="width:2%" resizable="false" />
                                 <p:column headerText="Editar" style="width:6%" resizable="false">
                                    <p:rowEditor />
                                 </p:column>
                                 <p:column style="width:6%" rendered="false" resizable="false">
                                    <h:outputText value="#{concepto.id}" />
                                 </p:column>
                              </p:dataTable>
                           </td>
                        </tr>
                        <tr>
                           <td align="right" colspan="5">
                              <p:commandButton id="elimCon"
                                 disabled="#{autorizarController.disableEliminar}"
                                 widgetVar="eliminarConceptosBtn" process="conceptoDataTable,@this"
                                 update=":resolucionForm:msgPanelRes,:resolucionForm,confirmarDialog"
                                 action="#{autorizarController.validRemoveConcepto}" value="Eliminar"
                                 oncomplete="ocultarMessages();">
                              </p:commandButton>
                              <p:confirmDialog closable="false"
                                 message="#{msg['vuj.resolucion.confirmarElimnarConceptos']}"
                                 visible="#{autorizarController.banderaRemove}" id="confirmarDialog"
                                 widgetVar="confirmarAccion" showEffect="fade">
                                 <table width="100%">
                                    <tr>
                                       <td align="right">
                                          <p:commandButton
                                             oncomplete="confirmarAccion.hide()" value="Si"
                                             process="@this,confirmarDialog"
                                             update=":resolucionForm:msgPanelRes,@this,:infoAdicionalForm:conceptoPanel,confirmarDialog,:resolucionForm"
                                             actionListener="#{autorizarController.removeConcepto}"
                                             styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                          <p:commandButton
                                             value="No" oncomplete="confirmarAccion.hide()"
                                             process="@this,confirmarDialog"
                                             update="@this,:infoAdicionalForm:conceptoPanel,confirmarDialog"
                                             actionListener="#{autorizarController.banderaFalse}"
                                             styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                       </td>
                                    </tr>
                                 </table>
                              </p:confirmDialog>
                           </td>
                        </tr>
                     </table>
                  </p:panel>
               </p:panel>
               <table>
                  <tr>
                     <td>
                        <p:panel id="resolucionSentidoPanel"
                           header=" #{msg['rrl.emitir.resolucion.resoluciones.impuganadas']} ">
                           <p:dataTable editable="true" editMode="cell" id="resolucionesImpuganadasTable"
                              paginator="true" rows="5" var="resolucion"
                              value="#{autorizarController.resolucionesDTOList}"
                              emptyMessage="#{msg['vuj.grid.vacio']}">
                              <p:column headerText="#{msg['rrl.emitir.resolucion.resolucion.impugnada']}">
                                 <h:outputText value="#{resolucion.resImpugnada}" />
                                 <pe:tooltip for="resolucionesImpuganadasTable"
                                    value="#{msg['atender.requerimiento.resolucionesImpugnadas']}" />
                              </p:column>
                              <p:column headerText="#{msg['rrl.emitir.resolucion.resolucion.sentido']}">
                                 <p:selectOneMenu id="selectSentido" effect="fade" filter="true"
                                    filterMatchMode="contains"
                                    valueChangeListener="#{autorizarController.actualizarSentidosResolucion}"
                                    value="#{resolucion.ideSentidoResolucion}"
                                    requiredMessage="#{errmsg['vuj.resolucion.sentidoObligatorio']}"
                                    converter="#{sentidoResolucionConverter}" style="width:80%;">
                                    <f:selectItem itemValue="" itemLabel="#{msg['vuj.combo.seleccione']}" />
                                    <f:selectItems value="#{autorizarController.sentidosResolucion}"
                                       var="sentido" itemValue="#{sentido}" itemLabel="#{sentido.descripcion}" />
                                    <p:ajax event="change" process="@this"
                                       update=":resolucionForm:resolucionTablePanel,@this" />
                                    <f:attribute name="sentido" value="#{sentido.clave}" />
                                 </p:selectOneMenu>
                                 <p:message for="selectSentido" display="text" />
                              </p:column>
                           </p:dataTable>
                        </p:panel>
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:panel id="panelAgravios" visible="#{autorizarController.visibleAgravios}"
                           header=" #{msg['rrl.emitir.resolucion.agravios']} ">
                           <p:pickList id="agraviosList"
                              requiredMessage="#{errmsg['vuj.resolucion.agravioObligatorio']}"
                              value="#{autorizarController.agravios}" var="agravio"
                              itemLabel="#{agravio.descripcion}" itemValue="#{agravio}"
                              converter="#{agravioConverter}">
                              <p:ajax event="transfer" partialSubmit="false"
                                 listener="#{autorizarController.actualizarResolucionImpugnada}" />
                              <f:facet name="sourceCaption">#{msg['rrl.emitir.resolucion.agravios.disponibles']}</f:facet>
                              <f:facet name="targetCaption">#{msg['rrl.emitir.resolucion.agravios.agregados']}</f:facet>
                           </p:pickList>
                           <pe:tooltip for="panelAgravios" value="#{msg['atender.requerimiento.sentido']}" />
                        </p:panel>
                     </td>
                  </tr>
                  <tr>
                     <td>
                        <p:panel visible="#{autorizarController.visibleRecursoPanel}" id="recursoPanel"
                           header="Caracteristicas Adicionales del Recurso">
                           <p:pickList converter="#{recursoConverter}" id="recursoPickList"
                              value="#{autorizarController.recursoDual}" var="recurso"
                              itemLabel="#{recurso.descripcion}" itemValue="#{recurso}">
                              <p:ajax event="transfer" listener="#{autorizarController.actualizarRecursos}" 
                                 update=":exFondoForm:panelExclusivoFondo,:resolucionForm:funcionarioPanel"/>
                           </p:pickList>
                           <p:message display="text" for="recursoPickList" />
                           <pe:tooltip for="recursoPanel" value="#{msg['atender.requerimiento.caractAdicionales']}" />
                        </p:panel>
                     </td>
                  </tr>
               </table>
            </p:panel>
         </h:form>
         <h:form id="exFondoForm">
            <p:panel id="panelExclusivoFondo" style="float:left;width: 100%;">
               <p:growl id="msgsExFondo" showDetail="true" />
               <p:panel  header="#{msg['exclusivo.informacion.recurso']}" id="panelExFonDato" visible="#{autorizarController.mostrarPanelExclusivoFondo}">
                  <table>
                     <tr>
                        <td>
                           <h:outputText value="#{msg['vuj.documento.anexar.tipoDocumento']}" />
                           <h:graphicImage id="tooltopTipoDocumento" url="/resources/css/images/ayuda.png" />
                           <pe:tooltip for="tooltopTipoDocumento" value="#{msg['exclusivo.tooltip.documento']}" adjustX="20" adjustY="20" mouseTracking="true" showEffect="fade" />
                        </td>
                        <td>
                           <h:outputText value="#{msg['rrl.requerimiento.fechaNotificacion']}" />
                        </td>
                        <td>
                           <h:outputText value="#{msg['rrl.requerimiento.fechaAudiencia']}" />
                        </td>
                     </tr>
                     <tr>
                        <td>
                           <p:selectOneMenu id="docExcusivoFondo" value="#{autorizarController.id}" filter="true" filterMatchMode="contains" 
                              widgetVar="comboDocs" onchange="validarComboDocumentos(this);" valueChangeListener="#{autorizarController.comboExclusivoChanged}" disabled="#{!autorizarController.tablaExclusivoEditar}">
                              <p:ajax event="change" update="@this"/>
                              <f:selectItem itemLabel="#{msg['vuj.combo.seleccione']}" itemValue="" />
                              <f:selectItems value="#{autorizarController.documentosExclusivoFondo}"  var="documento"
                                 itemLabel="#{documento.descripcion}"
                                 itemValue="#{documento.clave}" />
                           </p:selectOneMenu>
                        </td>
                        <td>
                           <p:calendar pattern="dd/MM/yyyy" navigator="true" locale="es"
                              value="#{autorizarController.fechaNotifExclusivoFondo}" readonlyInput="true"
                              mindate="#{autorizarController.fechaMinimaExFondo}"
                              maxdate="#{autorizarController.fechaMaximaExcFondo}"
                              id="tableFechaNotifExclusivoFondo" 
                              widgetVar="calNotif">
                              <p:ajax event="dateSelect" listener="#{autorizarController.fechaNotifExclusivoFondoChanged}" update=":exFondoForm:msgsExFondo,:exFondoForm:anexarBtn,:exFondoForm:docExcusivoFondo"/>
                           </p:calendar>
                           <p:message for="tableFechaNotifExclusivoFondo" display="text" />
                        </td>
                        <td>
                           <p:calendar pattern="dd/MM/yyyy" navigator="true" locale="es"
                              value="#{autorizarController.fechaAudienciaExclusivoFondo}" readonlyInput="true"
                              mindate="#{autorizarController.fechaMinimaExFondo}"
                              maxdate="#{autorizarController.fechaMaximaExcFondo}"
                              id="tableFechaAudienciaExclusivoFondo" 
                              widgetVar="calAudi">
                              <p:ajax event="dateSelect" listener="#{autorizarController.fechaAudienciaExclusivoFondoChanged}" update=":exFondoForm:msgsExFondo,:exFondoForm:anexarBtn,:exFondoForm:docExcusivoFondo" />
                           </p:calendar>
                           <p:message for="tableFechaAudienciaExclusivoFondo" display="text" />
                        </td>
                     </tr>
                  </table>
                  <p:scrollPanel style="height:200px;" id="scrollExclusivoFondo" mode="native">
                     <p:dataTable id="tablaDocumentos" 
                        var="documento" 
                        value="#{autorizarController.documentoOficialDataModel}" 
                        emptyMessage="#{msg['vuj.grid.vacio']}"  
                        editable="#{autorizarController.tablaExclusivoEditar}"
                        selection="#{autorizarController.registrosEliminar}" 
                        widgetVar="docExFondoTableVar"	
                        rowKey="#{documento.rutaAzure}" 
                        paginator="true" 
                        rows="5"
                        style="border: 1px solid #848484;width:900px">
                        <p:ajax event="rowSelectCheckbox" update=":exFondoForm:tablaDocumentos,:exFondoForm:eliminarRegButton" listener="#{autorizarController.rowSelectCheckboxTablaDocumentos}" />
                        <p:ajax event="toggleSelect" listener="#{autorizarController.rowSelectAllCheckboxTablaDocumentos}" update=":exFondoForm:tablaDocumentos,:exFondoForm:eliminarRegButton"/>
                        <p:ajax event="rowUnselectCheckbox" update=":exFondoForm:tablaDocumentos,:exFondoForm:eliminarRegButton" listener="#{autorizarController.rowUnselectCheckboxTablaDocumentos}" />
                        <p:ajax event="rowEdit" listener="#{autorizarController.onRowEditListaDocumentosExFondo}" update=":exFondoForm:msgsExFondo,:exFondoForm:eliminarRegButton"/>
                        <p:column selectionMode="multiple" style="width:5%;" resizable="false" />
                        <p:column headerText="#{msg['vuj.documento.anexar.tipoDocumento']}" style="width:30%" resizable="false">
                           <h:outputText value="#{documento.descripcionTipoDocumento}" id="tipoDoc" />
                        </p:column>
                        <p:column headerText="#{msg['vuj.documento.anexar.fechaNotificacion']}" style="width:10%" resizable="false">
                           <p:cellEditor>
                              <f:facet name="output">
                                 <h:outputText value="#{documento.fechaNotificacion}">
                                    <f:convertDateTime pattern="dd/MM/yyyy" />
                                 </h:outputText>
                              </f:facet>
                              <f:facet name="input">
                                 <p:calendar pattern="dd/MM/yyyy" navigator="true" locale="es"
                                    value="#{documento.fechaNotificacion}" readonlyInput="true"
                                    mindate="#{autorizarController.fechaMinimaExFondo}"
                                    maxdate="#{autorizarController.fechaMaximaExcFondo}"
                                    id="tableFechaNotifExclusivoFondoEditor" valueChangeListener="#{autorizarController.fechaNotifChanged}"/>
                                 <p:message for="tableFechaNotifExclusivoFondoEditor" display="text" />
                              </f:facet>
                           </p:cellEditor>
                        </p:column>
                        <p:column headerText="#{msg['vuj.documento.anexar.fechaAudiencia']}" style="width:10%" resizable="false">
                           <p:cellEditor>
                              <f:facet name="output">
                                 <h:outputText value="#{documento.fechaAudiencia}" id="fecAudi">
                                    <f:convertDateTime pattern="dd/MM/yyyy" />
                                 </h:outputText>
                              </f:facet>
                              <f:facet name="input">
                                 <p:calendar pattern="dd/MM/yyyy" navigator="true" locale="es"
                                    value="#{documento.fechaAudiencia}" readonlyInput="true"
                                    mindate="#{autorizarController.fechaMinimaExFondo}"
                                    maxdate="#{autorizarController.fechaMaximaExcFondo}"
                                    id="tableFechaAudExclusivoFondo" valueChangeListener="#{autorizarController.fechaAudiChanged}"/>
                                 <p:message for="tableFechaAudExclusivoFondo" display="text" />
                              </f:facet>
                           </p:cellEditor>
                        </p:column>
                        <p:column headerText="#{msg['vuj.documento.anexar.nombreArchivo']}" style="width:10%" resizable="false">
                           <p style="word-break: break-all;">
                              <h:outputText value="#{documento.nombreArchivo}" id="nomDocumento" />
                           </p>
                           <pe:tooltip for="nomDocumento" mouseTracking="true" adjustX="20" adjustY="20">
                              <p:outputLabel escape="true" value="#{documento.nombreArchivo}"></p:outputLabel>
                           </pe:tooltip>
                        </p:column>
                        <p:column headerText="#{msg['vuj.documento.tamanioDocumento']}" style="width:6%;white-space:pre-line;"
                           resizable="false">
                           <h:outputText value="#{documento.cadenaTamanioArchivo}">
                           </h:outputText>
                        </p:column>
                        <p:column style="width:6%;text-align:center;" resizable="false">
                           <p:commandButton value="#{msg['vuj.boton.ver']}" id="generarRuta" update=":exFondoForm:dialogVisor"
                              oncomplete="visorDialog.show()" style="width:auto;">
                              <f:setPropertyActionListener value="#{documento}"
                                 target="#{autorizarController.documentoOficialSelected}" />
                              <p:ajax event="click" listener="#{autorizarController.activaBanderaDocumentoPromocion}" />
                           </p:commandButton>
                           <pe:tooltip for="generarRuta" adjustX="10" adjustY="10" value="#{msg['contribuyente.ver.documento']}"
                              mouseTracking="true" atPosition="top right" />
                        </p:column>
                        <p:column style="width:32px" headerText="Editar">
                           <p:rowEditor rendered="#{documento.editarDocumSelect}"/>
                        </p:column>
                     </p:dataTable>
                  </p:scrollPanel>
                  <table style="float: left;" cellpadding="1" width="100%">
                     <tr>
                        <td colspan="3" align="right">
                           <p:commandButton id="eliminarRegButton" value="#{msg['vuj.boton.eliminar']}"
                              update=":exFondoForm:tablaDocumentos,@this" onclick="inicializarCombo();"
                              disabled="#{!autorizarController.eliminarVisible}" process="@this,:exFondoForm:tablaDocumentos"
                              oncomplete="cdEliminarExFon.show();"/>
                           <p:confirmDialog message="#{msg['vuj.confirmacion.eliminarExFon']}" showEffect="fade"
                              hideEffect="explode" header="Confirmación" severity="alert" widgetVar="cdEliminarExFon">
                              <table align="right">
                                 <tr>
                                    <td>
                                       <p:commandButton value="Si"
                                          actionListener="#{autorizarController.eliminarDocumentos}"
                                          styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
                                          update=":exFondoForm,:exFondoForm:msgsExFondo,:resolucionForm:funcionarioPanel"
                                          oncomplete="cdEliminarExFon.hide();" />
                                       <p:commandButton
                                          value="No" onclick="cdEliminarExFon.hide();" type="button"
                                          styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                    </td>
                                 </tr>
                              </table>
                           </p:confirmDialog>
                        </td>
                     </tr>
                     <tr>
                        <td colspan="3" align="right">
                           <p:commandButton id="anexarBtn"
                              update=":exFondoForm:display,:exFondoForm:dlgAnexar,:resolucionForm:funcionarioPanel,:exFondoForm:guardarBtn,:resolucionForm:msgPanelRes" widgetVar="anexarBtnW"
                              disabled="#{!autorizarController.agregarVisible}" oncomplete="anexarDialogo.show()"
                              value="#{msg['vuj.boton.adjuntar']}">
                           </p:commandButton>
                        </td>
                     </tr>
                     <tr>
                        <td colspan="3" align="right">
                           <p:commandButton id="guardarBtn" value="#{msg['vuj.resol.guardar']}" oncomplete="cdGuardarResImp.show()" disabled="#{autorizarController.inhabilitarGuardar}" />
                        </td>
                     </tr>
                  </table>
                  <table style="float: left;" cellpadding="1" width="100%">
                     <tr>
                        <td colspan="3">
                           <p:dialog id="dialogVisor" widgetVar="visorDialog" styleClass="dialogVisor" header="PDF" dynamic="true" modal="true"
                              position="left top" closeOnEscape="true" draggable="false" resizable="false">
                              <c:if test="#{not empty autorizarController.urlDescargaSelected}">
                                 <p:media player="pdf" value="#{autorizarController.urlDescargaSelected}" styleClass="dialogMedia"
                                    width="780px" height="480px">
                                    Su navegador no es compatible con la vista previa de pdfs. Para descargar el documento de click en esta
                                    <a href="#{autorizarController.urlDescargaSelected}" target="_blank"> liga </a>
                                 </p:media>
                              </c:if>
                           </p:dialog>
                        </td>
                     </tr>
                     <tr>
                        <td colspan="3">
                           <p:dialog id="dlgAnexar" widgetVar="anexarDialogo" header="#{msg['vuj.documento.anexar.tituloDialogo']}"
                              modal="true" resizable="false">
                              <h:panelGrid id="display" columns="2" cellpadding="4"
                                 style="margin:0 auto;">
                                 <h:form id="formUpload" enctype="multipart/form-data;charset=UTF-8" style="width:500px">
                                    <p:growl id="msgsUpload" showDetail="true" />
                                    <h2>Adjuntar archivo</h2>
                                    <br />
                                    <p:fileUpload
                                       widgetVar="formUploadWidget" 
                                       value="#{autorizarController.archivo}"
                                       invalidSizeMessage="El tamaño máximo por archivo es 4 MB."
                                       invalidFileMessage="El tipo de documento que trata de anexar no cumple con los requisitos. No está en un formato válido de PDF."
                                       mode="advanced" multiple="false" fileLimit="1"
                                       allowTypes="/(\.|\/)(pdf|pd?f)$/"
                                       fileUploadListener="#{autorizarController.fileUploadListenerGrowl}"
                                       sizeLimit = "4194303"
                                       oncomplete="termina();" 
                                       showButtons="true"
                                       uploadLabel="Adjuntar"
                                       cancelLabel="Cancelar"
                                       label="Seleccionar"
                                       update="msgsUpload"
                                       >
                                    </p:fileUpload>
                                 </h:form>
                              </h:panelGrid>
                              <p:panelGrid columns="1" styleClass="noBorder" style="float:right;">
                                 <p:column>
                                    <p:commandButton onclick="anexarDialogo.hide();" value="Cerrar" />
                                 </p:column>
                              </p:panelGrid>
                           </p:dialog>
                        </td>
                     </tr>
                  </table>
               </p:panel>
            </p:panel>
         </h:form>
         <h:form id="pform">
            <p:commandButton action="#{autorizarController.anexarDocumentoNube}" id="anexarNube"
               update=":exFondoForm:tablaDocumentos,:exFondoForm:guardarBtn,:resolucionForm:funcionarioPanel" style="display:none" />
         </h:form>
         <p:panel id="solicitantePanel">
            <ui:decorate template="../consultas/consulta.xhtml">
            </ui:decorate>
         </p:panel>
         <script type="text/javascript">
            function termina(){
            $('#pform\\:anexarNube').click();
            inicializarCombo();
            anexarDialogo.hide();
            anexarBtnW.disable();
            }
                $(document).ready(function() {
            validarComboDocumentos(comboDocs);
            });
            
            function validarComboDocumentos(val){
            if(val.value == null || val.value == ""
            || comboDocs.getSelectedValue() == ""){
            comboDocs.selectValue("");
            calNotif.setDate(null);
            calAudi.setDate(null);
            anexarBtnW.disable();
            calNotif.disable();
            calAudi.disable();
            }else{
            if(val.value =="TIDOF.AACC" || val.value =="TIDOF.AASC" || val.value =='TIDOF.AUEP'|| val.value=='TIDOF.DIRR'
            || val.value == 'TIDOF.DFRR' || val.value =='TIDOF.IRR' || val.value =='TIDOF.PAC' || val.value == 'TIDOF.PAP' 
            || val.value =='TIDOF.OTROS' || val.value =='TIDOF.ANC' || val.value =='TIDOF.ANP'){
            calNotif.setDate(null);
            calAudi.setDate(null);
            calNotif.disable();
            calAudi.disable();
            anexarBtnW.enable();
            }else if(val.value=="TIDOF.OASA"){
            calNotif.setDate(null);
            calAudi.setDate(null);
            calNotif.enable();
            calAudi.disable();
            anexarBtnW.disable();
            }else{
            calNotif.setDate(null);
            calAudi.setDate(null);
            calNotif.enable();
            calAudi.enable();
            anexarBtnW.disable();
            }
            }
            }
            function validarFechaNotif(){
            var comboSelec = comboDocs.getSelectedValue();
            if(comboSelec == 'TIDOF.OASA'){
            anexarBtnW.enable();
            }
            }
            function validarFechaAudiencia(){
            var comboSelec = comboDocs.getSelectedValue();
            alert("Fecha de notificacion:"+calNotif.getDate()+" Fecha audiencia:"+calAudi.getDate());
            if(comboSelec == 'TIDOF.OACA' || comboSelec == 'TIDOF.OAEP'){
            if(calAudi.getDate() > calNotif.getDate()){
            anexarBtnW.enable();	
            }else{
            anexarBtnW.disable();
            alert("La fecha de audiencia no puede ser menor que la fecha de notificación");
            }
            
            }
            }
                function habilitarBtnAnexar(val){
            if(val.value == null || val.value == ""
            || comboDocs.getSelectedValue() == ""){
            comboDocs.selectValue("");
            calNotif.setDate(null);
            calAudi.setDate(null);
            anexarBtnW.disable();
            }else{
            anexarBtnW.enable();
            }
            }
            function inicializarCombo() {
            comboDocs.selectValue("");
            calNotif.setDate(null);
            calAudi.setDate(null);
            calNotif.disable();
            calAudi.disable();
            }
            
            
            function modificaMontoValor() {
            
            var count = 0;
            
            var row = $("#resolucionForm\\:resolucionTable")
            .find("tbody:first").children("tr");
            row
            .each(function() {
            
            if ($("#resolucionForm\\:resolucionTable\\:" + count
            + "\\:determinanteCredId_input").is(':checked')) {
            
            $("#resolucionForm\\:resolucionTable\\:"
            + count + "\\:tableMontoInput_input").attr('disabled', false);
            
            $("#resolucionForm\\:resolucionTable\\:"
            + count + "\\:tableMontoInput_input").attr('required', true);
            
            if($("#resolucionForm\\:resolucionTable\\:" + count + "\\:tableMontoInput_input")
            	.attr('class').contains('ui-state-disabled')){
            
            $("#resolucionForm\\:resolucionTable\\:"
            	+ count + "\\:tableMontoInput_input").toggleClass('ui-state-disabled');
            
            }
            
            } else {
            $("#resolucionForm\\:resolucionTable\\:"
            + count + "\\:tableMontoInput_input").attr('disabled', true);
            
            $("#resolucionForm\\:resolucionTable\\:"
            + count + "\\:tableMontoInput_input").attr('required', false);
            	
            if(!$("#resolucionForm\\:resolucionTable\\:" + count + "\\:tableMontoInput_input")
            	.attr('class').contains('ui-state-disabled')){
            
            $("#resolucionForm\\:resolucionTable\\:"
            		+ count + "\\:tableMontoInput_input").toggleClass('ui-state-disabled');
            
            }
            
            }
            
            
            count = count + 1;
            
            /* $(this).find('td').each(function(){
                 alert('inside each cell');
                 count = count+1;
            }); */
            });
            
            }
            
            function dataTableChangeCheckbox(select) {
            var id = select.name.substring(select.name
            .lastIndexOf('resolucionForm'));
            var splitSelect1 = select.name
            .split("resolucionForm:resolucionTable:");
            var splitSelect2 = splitSelect1[1]
            .split(":determinanteCredId_input");
            var index = splitSelect2[0];
            
            $("#resolucionForm\\:resolucionTable\\:" + index
            + "\\:tableMontoInput").val("0.00");
            
            $("#resolucionForm\\:resolucionTable\\:" + index
            + "\\:tableMontoInput_input").val("0.00");
            
            if ($("#resolucionForm\\:resolucionTable\\:" + index
            + "\\:determinanteCredId_input").is(':checked')) {
            
            $("#resolucionForm\\:resolucionTable\\:" + index
            + "\\:tableMontoInput").attr('disabled', false);
            
            $("#resolucionForm\\:resolucionTable\\:" + index
            + "\\:tableMontoInput_input").attr('disabled', false);
            
            if( $("#resolucionForm\\:resolucionTable\\:" + index + "\\:tableMontoInput_input")
            .attr('class').contains('ui-state-disabled')){
            
            $("#resolucionForm\\:resolucionTable\\:"
            + index + "\\:tableMontoInput_input").toggleClass('ui-state-disabled');
            }
            
            //restablece el limite del monto de la resolicion capturable
            // 				restoreMaxResolValueCommand();
            
            } else {
            $("#resolucionForm\\:resolucionTable\\:" + index
            + "\\:tableMontoInput").attr('disabled', true);
            
            $("#resolucionForm\\:resolucionTable\\:" + index
            + "\\:tableMontoInput_input").attr('disabled', true);
            
            if(!$("#resolucionForm\\:resolucionTable\\:" + index + "\\:tableMontoInput_input")
            .attr('class').contains('ui-state-disabled')){
            
            $("#resolucionForm\\:resolucionTable\\:"
            + index + "\\:tableMontoInput_input").toggleClass('ui-state-disabled');
            }
            
            //elimina la restriccion de tamaño del monto de la resolucion 
            // 				deleteMaxResolValueCommand();
            }
            
            }
            function habilitatableMontoInput() {
            var count = 0;
            
            var row = $("#resolucionForm\\:resolucionTable")
            .find("tbody:first").children("tr");
            row
            .each(function() {
            
            $("#resolucionForm\\:resolucionTable\\:" + count
            + "\\:tableMontoInput").attr('disabled', false);
            $("#resolucionForm\\:resolucionTable\\:" + count
            + "\\:tableMontoInput_input").attr('disabled', false);
            
            if( $("#resolucionForm\\:resolucionTable\\:" + count + "\\:tableMontoInput_input")
            .attr('class').contains('ui-state-disabled')){
            
            $("#resolucionForm\\:resolucionTable\\:"
            + count + "\\:tableMontoInput_input").toggleClass('ui-state-disabled');
            }
            
            count = count + 1;
            
            });
            
            }
            
            
            function validMensaje() {
            
            if (($("#infoAdicionalForm\\:conceptoImporteInput_input").val().length == 0)
            || ($("#infoAdicionalForm\\:selectConceptoMenu_input").val().length == 0)) {
            
            $('#errorConcepto').show();
            
            } else {
            $('#errorConcepto').hide();
            cdAgregarConcepto.show();
            }
            
            }
            
            function ocultarMessages() {
            $('#messages').hide();
            }
            function ocultarMessagesRes() {
            $('#resolucionForm\\:messagesRes').hide();
            }
            
            
            
            function resetearMonto() {
            $('#resolucionForm\\:montoInput').val("0");
            
            }
            
            function deshabilitaMontoImput() {
            document.getElementsByName('#resolucionForm\\:montoInput').disabled = true;
            }
            
            function borrarInputConcepto() {
            $('#infoAdicionalForm\\:conceptoImporteInput').val('');
            }
            
            function reloadMontoResol(inputMontoResol){
            var rowIndex = inputMontoResol.source.split(":");
            var updateId = "resolucionForm:resolucionTable:"+ rowIndex[2] + ":tableMontoInput";
            PrimeFaces.ajax.AjaxRequest({
            source:updateId,
            update:updateId,
            proccess:updateId,
            execute:updateId
            });
            
            }
            
            function actualizarDataTable() {
            if ($('#idBanderaResolucionImpugnada').val() == 'true') {
            $('#actualizarTableButton').click();
            }
            
            }
            function unselectCheckConceptos(){
               conceptosDataTable.unselectAllRows();
               eliminarConceptosBtn.disable();
            }
            
            function unselectCheckResol(){
                $( ".ui-state-active" ).removeClass( "ui-state-active" );
            $( ".ui-icon-bullet" ).removeClass( "ui-icon-bullet ui-icon" );
            resolucionTableVar.unselectAllRows();
            }
            
            function marcarRequeridoConceptoInput(){
                if ($('#infoAdicionalForm\\:conceptoImporteInput_input').val().length == 0){
                    $('#infoAdicionalForm\\:conceptoImporteInput_input').addClass('ui-state-error');
                }else{
                    $('#infoAdicionalForm\\:conceptoImporteInput_input').removeClass('ui-state-error')
                }
            }
            
         </script>
         <h:outputScript name='/js/calendar_es.js' target="head" />
      </ui:define>
   </ui:composition>
</html>